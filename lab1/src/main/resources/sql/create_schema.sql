CREATE TABLE IF NOT EXISTS game_event (
    game_event_id SERIAL PRIMARY KEY,
    description_ua VARCHAR(255) NOT NULL
);

CREATE TABLE IF NOT EXISTS event (
    event_id SERIAL PRIMARY KEY,
    game_event_id INT NOT NULL,
    device_udid VARCHAR(255) NOT NULL,
    date_created TIMESTAMP NOT NULL DEFAULT NOW(),
    event_date DATE NOT NULL,
    FOREIGN KEY (game_event_id) REFERENCES game_event (game_event_id)
)
PARTITION BY RANGE (event_id);
;

CREATE TABLE IF NOT EXISTS event_1_1000000 PARTITION OF event FOR VALUES FROM (1) TO (1000001);
CREATE TABLE IF NOT EXISTS event_1000001_2000000 PARTITION OF event FOR VALUES FROM (1000001) TO (2000001);
CREATE TABLE IF NOT EXISTS event_2000001_3000000 PARTITION OF event FOR VALUES FROM (2000001) TO (3000001);
CREATE TABLE IF NOT EXISTS event_3000001_4000000 PARTITION OF event FOR VALUES FROM (3000001) TO (4000001);
CREATE TABLE IF NOT EXISTS event_4000001_5000000 PARTITION OF event FOR VALUES FROM (4000001) TO (5000001);
CREATE TABLE IF NOT EXISTS event_5000001_6000000 PARTITION OF event FOR VALUES FROM (5000001) TO (6000001);
CREATE TABLE IF NOT EXISTS event_6000001_7000000 PARTITION OF event FOR VALUES FROM (6000001) TO (7000001);
CREATE TABLE IF NOT EXISTS event_7000001_8000000 PARTITION OF event FOR VALUES FROM (7000001) TO (8000001);
CREATE TABLE IF NOT EXISTS event_8000001_9000000 PARTITION OF event FOR VALUES FROM (8000001) TO (9000001);
CREATE TABLE IF NOT EXISTS event_9000001_10000000 PARTITION OF event FOR VALUES FROM (9000001) TO (10000001);
CREATE TABLE IF NOT EXISTS event_10000001_2000000000 PARTITION OF event FOR VALUES FROM (10000001) TO (2000000000);

CREATE TABLE IF NOT EXISTS first_start_event (
    event_id INT PRIMARY KEY,
    gender VARCHAR(255) NOT NULL,
    age INT NOT NULL,
    country VARCHAR(255),
    FOREIGN KEY (event_id) REFERENCES event (event_id)
);

CREATE TABLE IF NOT EXISTS stage_start_event (
    event_id INT PRIMARY KEY,
    stage INT NOT NULL,
    FOREIGN KEY (event_id) REFERENCES event (event_id)
);

CREATE TABLE IF NOT EXISTS stage_end_event (
    event_id INT PRIMARY KEY,
    stage INT NOT NULL,
    win BOOLEAN NOT NULL,
    time INT NOT NULL,
    income DECIMAL(10, 2),
    FOREIGN KEY (event_id) REFERENCES event (event_id)
);

CREATE TABLE IF NOT EXISTS item_purchase_event (
    event_id INT PRIMARY KEY,
    item VARCHAR(255) NOT NULL,
    price DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (event_id) REFERENCES event (event_id)
);

CREATE TABLE IF NOT EXISTS currency_purchase_event (
    event_id INT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    price DECIMAL(10, 2) NOT NULL,
    income DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (event_id) REFERENCES event (event_id)
);
